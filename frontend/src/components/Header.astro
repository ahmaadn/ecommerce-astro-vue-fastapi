---
import Cart from './Cart.astro'
import { Icon } from 'astro-icon/components'
import MenuNav from './MenuNav.astro'
---

<div class="drawer">
    <input id="my-drawer-3" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content flex flex-col">
        <!-- Navbar -->
        <!-- bg-base-100 text-base-content sticky top-0 z-30 flex h-16 w-full justify-center bg-opacity-90 backdrop-blur transition-shadow duration-100 [transform:translate3d(0,0,0)]  -->
        <div
            id="navbar"
            class="sticky top-0 z-20 flex h-16 w-full justify-center border-b border-base-200 bg-base-100 bg-opacity-90 backdrop-blur transition-shadow duration-100 [transform:translate3d(0,0,0)]"
        >
            <nav class="navbar w-full">
                <div class="flex-none lg:hidden">
                    <label
                        for="my-drawer-3"
                        aria-label="open sidebar"
                        class="btn btn-square btn-ghost"
                    >
                        <Icon name="mdi:hamburger-menu" size={24} />
                    </label>
                </div>
                <a href="/" class="mx-2 flex-1 px-2 text-xl font-semibold">Online Shop</a>
                <div class="hidden flex-none lg:block">
                    <MenuNav />
                </div>
                <div class="flex-none">
                    <Cart />
                </div>
            </nav>
        </div>
        <!-- CONTENT -->
        <slot />
    </div>
    <nav class="drawer-side z-20">
        <label for="my-drawer-3" aria-label="close sidebar" class="drawer-overlay"></label>
        <MenuNav oriented="vertical" />
    </nav>
</div>

<script>
    document.addEventListener('astro:page-load', () => {
        const navbar = document.querySelector<HTMLElement>('#navbar')
        if (navbar) {
            let offset = navbar.offsetHeight
            window.onscroll = function () {
                if (window.scrollY > offset - 10) {
                    navbar.classList.add('shadow-sm')
                } else if (window.scrollY < offset - 20) {
                    navbar.classList.remove('shadow-sm')
                }
            }
        }
    })
</script>
